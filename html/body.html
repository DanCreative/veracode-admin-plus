<tbody id="body">  
    {{ range $i, $user := . }}
        <tr>
            <td class="details">{{ $user.EmailAddress }}</td>
            <td class="details">{{ $user.AccountType }}</td>
            {{ range $user.Roles}}
                {{ if not .IsScanType}}
                    {{ if .IsAddScanTypes }}
                        <td><input hx-put="/users/{{ $user.UserId }}" hx-trigger="change" hx-include=".roles-{{ $user.UserId }}" type="checkbox" name="{{ .RoleName }}" id="{{ .RoleName }}" script="init if me.checked increment ${{ $i }} end on click if me.checked increment ${{ $i }} then else decrement ${{ $i }} end then send ${{ $i }}roles to .scan-type" {{ if .IsChecked }} checked {{ end }} {{ if .IsDisabled }} disabled {{ end }} class="roles-{{ $user.UserId }}"></td>
                    {{ else }}
                        <td><input hx-put="/users/{{ $user.UserId }}" hx-trigger="change" hx-include=".roles-{{ $user.UserId }}" type="checkbox" name="{{ .RoleName }}" id="{{ .RoleName }}" {{ if .IsChecked }} checked {{ end }} {{ if .IsDisabled }} disabled {{ end }} class="roles-{{ $user.UserId }}"></td>
                    {{ end }}
                {{ end }}
            {{ end }}
            <td>
                <button script="on click toggle .hide-scan-types-box on the next <div/>">show</button>
                <div class="hide-scan-types-box scan-types-box">
                    {{ range .Roles}}
                        {{ if .IsScanType}}
                            <label for="{{ .RoleName }}">{{ .RoleDescription }}</label>
                            {{ if ne .RoleName "extsubmitanyscan"}}
                                <input hx-put="/users/{{ $user.UserId }}" hx-trigger="change" hx-include=".roles-{{ $user.UserId }}" type="checkbox" name="{{ .RoleName }}" id="{{ .RoleName }}" script="on ${{ $i }}roles if ${{ $i }} is 0 add @disabled then set me.checked to false else remove @disabled end on click send ${{ $i }}nany to .any-scan end on ${{ $i }}any set me.checked to false end" {{ if .IsChecked }} checked {{ end }} {{ if .IsDisabled }} disabled {{ end }} class= "roles-{{ $user.UserId }} scan-type not-any-scan"><br>
                            {{ else }}
                                <input hx-put="/users/{{ $user.UserId }}" hx-trigger="change" hx-include=".roles-{{ $user.UserId }}" type="checkbox" name="{{ .RoleName }}" id="{{ .RoleName }}" script="on ${{ $i }}roles if ${{ $i }} is 0 add @disabled then set me.checked to false else remove @disabled then set me.checked to true end on ${{ $i }}nany set me.checked to false end on click send ${{ $i }}any to .not-any-scan" {{ if .IsChecked }} checked {{ end }} {{ if .IsDisabled }} disabled {{ end }} class= "roles-{{ $user.UserId }} scan-type any-scan"><br>
                            {{ end }}
                        {{ end }}
                    {{ end }}
                </div>
            </td>
        </tr>
    {{ end }}
</tbody>